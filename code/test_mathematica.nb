(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10488,        282]
NotebookOptionsPosition[      9974,        265]
NotebookOutlinePosition[     10309,        280]
CellTagsIndexPosition[     10266,        277]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "previous", " ", "definitions", " ", "of", " ", "operators", 
    " ", "and", " ", "symbols"}], "*)"}], GridBox[{
    {
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"bK", ",", "bKDagger", ",", "omegaK", ",", "gK"}], "]"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Define", " ", "symbolic", " ", "creation", " ", "and", " ", 
        "annihilation", " ", "operators", " ", "for", " ", "each", " ", 
        "mode", " ", "k"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"N_modes", "=", "5"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Number", " ", "of", " ", "modes"}], "*)"}], 
       RowBox[{
        RowBox[{"bK", "[", "mode_", "]"}], ":=", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<b\>\"", "<>", 
          RowBox[{"ToString", "[", "mode", "]"}]}], "]"}]}], ";"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"bKDagger", "[", "mode_", "]"}], ":=", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<b\>\"", "<>", 
          RowBox[{"ToString", "[", "mode", "]"}], "<>", "\"\<\[Dagger]\>\""}],
          "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Define", " ", "symbolic", " ", "frequencies", " ", "omega_k", " ", 
        "and", " ", "coupling", " ", "constants", " ", "g_k"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"omegaK", "[", "k_", "]"}], ":=", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<omega\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Frequency", " ", "for", " ", "mode", " ", "k"}], "*)"}], 
       RowBox[{
        RowBox[{"gK", "[", "k_", "]"}], ":=", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<g\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Coupling", " ", "constant", " ", "for", " ", "mode", " ", "k"}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Define", " ", "the", " ", "Hamiltonian", " ", "of", " ", "the", " ", 
          RowBox[{"bath", ":", "H_bath"}]}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{"omega_k", " ", "b_k\[Dagger]", " ", "b_k"}], "]"}]}], 
        "*)"}], 
       RowBox[{"H_bath", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"omegaK", "[", "k", "]"}], " ", 
           RowBox[{"bKDagger", "[", "k", "]"}], " ", 
           RowBox[{"bK", "[", "k", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "N_modes"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Define", " ", "the", " ", "coupling", " ", "operator", " ", "B"}], 
        "=", 
        RowBox[{"Sum", "[", 
         RowBox[{"g_k", " ", 
          RowBox[{"(", 
           RowBox[{"b_k\[Dagger]", "+", "b_k"}], ")"}]}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"B", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gK", "[", "k", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bKDagger", "[", "k", "]"}], "+", 
             RowBox[{"bK", "[", "k", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "N_modes"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Now", " ", "we", " ", "define", " ", "the", " ", "total", " ", 
         RowBox[{"Hamiltonian", ":", "H_total"}]}], "=", 
        RowBox[{"H_bath", "+", "B"}]}], "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Use", " ", "Hold", " ", "to", " ", "prevent", " ", "evaluation", " ", 
        "until", " ", "explicitly", " ", "needed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"H_total", "=", 
        RowBox[{"Hold", "[", 
         RowBox[{"H_bath", "+", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "check", " ", "the", " ", "Hamiltonians", " ", "to", " ", 
        "make", " ", "sure", " ", "they", " ", "are", " ", "correct"}], 
       "*)"}], "\[IndentingNewLine]", "H_bath", "\n", "B", "\n", "H_total", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Time", " ", "evolution", " ", "of", " ", "the", " ", "coupling", " ", 
        "operator", " ", "B", 
        RowBox[{"(", "t", ")"}], " ", "in", " ", "the", " ", "Heisenberg", 
        " ", "picture"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"Symbol", "[", "\"\<t\>\"", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Time", " ", "variable"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Using", " ", "Hold", " ", "to", " ", "prevent", " ", "immediate", 
         " ", "evaluation", " ", "of", " ", "the", " ", "time", " ", 
         "evolution", " ", "expression"}], "*)"}], 
       RowBox[{"B_t", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"I", " ", "H_total", " ", "t"}], "]"}], ".", "B", ".", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", "H_total", " ", "t"}], "]"}]}]}], ";"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Define", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
        "the", " ", "bath", " ", 
        RowBox[{"(", 
         RowBox[{"thermal", " ", "state"}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"beta", "=", 
        RowBox[{"Symbol", "[", "\"\<beta\>\"", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Inverse", " ", "temperature"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"Partition", " ", "function", " ", "calculation", " ", 
         RowBox[{"(", "symbolically", ")"}]}], "*)"}], 
       RowBox[{"Z", "=", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "beta"}], " ", "H_bath"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"bK", "[", "1", "]"}], ",", 
            RowBox[{"bKDagger", "[", "1", "]"}]}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Define", " ", "the", " ", "density", " ", "matrix", " ", "for", " ", 
        "the", " ", "bath"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rho_bath", "=", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "beta"}], " ", "H_bath"}], "]"}], "/", "Z"}]}], ";"}],
       "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Compute", " ", "the", " ", "correlation", " ", "function"}], 
        "<", 
        RowBox[{"B", 
         RowBox[{"(", "t", ")"}], " ", "B"}], ">", "_Bath"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"correlation", "=", 
        RowBox[{"Tr", "[", 
         RowBox[{"rho_bath", ".", "B_t", ".", "B"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Simplify", " ", "the", " ", "correlation", " ", "function", " ", "if",
         " ", "needed"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"simplifiedCorrelation", "=", 
        RowBox[{"FullSimplify", "[", "correlation", "]"}]}], ";"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{"Optionally", ",", 
        RowBox[{
        "display", " ", "the", " ", "result", " ", "for", " ", "the", " ", 
         "simplified", " ", "correlation", " ", "function"}]}], "*)"}], 
      "\[IndentingNewLine]", "simplifiedCorrelation", "\n"}]},
    {"\[Placeholder]"}
   }]}]], "Input",
 CellChangeTimes->{{3.949634559769721*^9, 3.9496345603418283`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"b6ca67b1-8e90-442e-b1fb-b4333f622cef"],

Cell[BoxData[
 TemplateBox[{
  "Rule","rhs",
   "\"Pattern \\!\\(\\*RowBox[{\\\"H_bath\\\"}]\\) appears on the right-hand \
side of rule \\!\\(\\*RowBox[{\\\"H_total\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"Hold\\\", \\\"[\\\", RowBox[{\\\"H_bath\\\", \\\"+\\\", \
\\\"B\\\"}], \\\"]\\\"}]}]\\).\"",2,28,24,32126144065174563151,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.949634562533873*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"d4c2abd3-ea47-48bc-93ae-54b469523f2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bk", "+", "bk\[Dagger]"}], ")"}], " ", "gk", " ", 
     SuperscriptBox["Null", "11"], " ", "H_bath", " ", "H_total", " ", 
     "N_modes", " ", 
     RowBox[{"Tr", "[", 
      RowBox[{"rho_bath", ".", "B_t", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bk", "+", "bk\[Dagger]"}], ")"}], " ", "gk", " ", 
         "N_modes"}], ")"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", "\[Placeholder]", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9496345625485163`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"b53be2db-1c06-4c87-913e-6f9e7b6e313d"]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{556, Automatic}, {29, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8167, 207, 963, "Input",ExpressionUUID->"b6ca67b1-8e90-442e-b1fb-b4333f622cef"],
Cell[8750, 231, 520, 11, 25, "Message",ExpressionUUID->"d4c2abd3-ea47-48bc-93ae-54b469523f2b"],
Cell[9273, 244, 685, 18, 123, "Output",ExpressionUUID->"b53be2db-1c06-4c87-913e-6f9e7b6e313d"]
}, Open  ]]
}
]
*)

